<div class="flex relative">
  <div
    pRipple
    class="p-2 rounded-circle cursor-pointer user-avatar-menu-button"
    title="{{ 'REMOTES.USER_AVATAR_MENU.TOOLTIP' | translate }}"
    pTooltip="{{ 'REMOTES.USER_AVATAR_MENU.TOOLTIP' | translate }}"
    tooltipPosition="bottom"
    (click)="handleAvatarClick($event)"
  >
    <ocx-user-avatar [user$]="currentUser$"></ocx-user-avatar>
  </div>
  <ul class="layout-topbar-action-panel shadow-6 m-2 absolute top-100" [hidden]="!menuOpen">
    <li class="layout-topbar-action-item flex flex-column" *ocxIfPermission="'PROFILE#VIEW'">
      <div *ngIf="currentUser$ | async as user">
        <h5 class="flex flex-row align-items-center justify-content-center text-color-secondary">
          {{ user.person.displayName }}
        </h5>
        <span class="flex flex-row align-items-center justify-content-center text-color-secondary">
          {{ user.person.email }}</span
        >
        <span
          *ngIf="user.tenantName"
          class="flex flex-row align-items-center justify-content-center text-color-secondary"
        >
          {{ 'REMOTES.USER_AVATAR_MENU.TENANT' | translate }}: {{ user.tenantName }}</span
        >
      </div>
    </li>
    <ng-container *ngIf="userMenu$ | async as userMenu">
      <li class="layout-topbar-action-item" *ngFor="let item of userMenu.menu![0].children; let i = index">
        <a class="flex flex-row align-items-center w-full h-full p-3" pRipple [routerLink]="item.url">
          <i [ngClass]="'pi-' + item.badge || ''" class="layout-menuitem-icon pi"></i>
          <span class="layout-menuitem-text ml-2">{{ item.name }}</span>
        </a>
      </li>
    </ng-container>
    <li class="layout-topbar-action-item">
      <a class="flex flex-row align-items-center w-full h-full p-3" pRipple (click)="logout($event)">
        <i class="mr-2 pi pi-power-off"></i>
        <span>{{ 'REMOTES.USER_AVATAR_MENU.LOGOUT' | translate }}</span>
      </a>
    </li>
  </ul>
</div>
